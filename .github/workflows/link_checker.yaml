name: Link Checker

on:
    repository_dispatch:
        types: [audit_link_checker]

    workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                url: ["https://londonparkour.com", "https://ioroot.com"]

        steps:
            - uses: actions/checkout@v3

            - name: Set up Go
              uses: actions/setup-go@v4
              with:
                  go-version: "1.18"

            - name: Install Muffet
              run: |
                  export GO111MODULE=on
                  go install github.com/raviqqe/muffet/v2@latest

            - name: Audit
              run: |
                  muffet --exclude=google.com --buffer-size=8192 --max-connections=10 --color=always --verbose "${{ matrix.url }}"

name: Link Checker

on:
    repository_dispatch:
        types: [audit_link_checker]

    workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3

            - name: Set up Go
              uses: actions/setup-go@v4
              with:
                  go-version: "1.15"

            - name: Install muffet
              run: |
                  export GO111MODULE=on
                  go install github.com/raviqqe/muffet/v2@latest

            - name: audit
              run: |
                  muffet --exclude=google.com --buffer-size=8192 --max-connections=10 --color=always --verbose ${{ matrix.url }}
